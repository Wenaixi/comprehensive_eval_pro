# 📂 资源与规则指南

CEP 支持从本地 `assets/` 目录中自动匹配并上传素材。本指南将详细说明如何组织你的资源文件。

---

## 🏗️ 目录结构规范

为了实现精准匹配，请务必遵循以下结构：

```text
assets/
├── 劳动/
│   └── <学校名>/
│       ├── 默认/             # 全校通用图片
│       └── <年级>/<班级>/     # 班级专属图片
├── 军训/
│   └── <学校名>/
│       └── <年级>/<班级>/
├── 国旗下讲话/
│   └── <学校名>/
│       └── 默认/
└── 主题班会/
    └── <学校名>/
        └── <年级>/<班级>/
            └── <班会资源包>/  # 一个班会一个文件夹
```

---

## 📸 图片处理规则

- **支持格式**: `.jpg`, `.png`, `.webp`, `.bmp`, `.tiff` 等。
- **自动处理**: 系统在上传前会执行以下操作：
  - 自动转换为 **JPG** 格式以兼容服务端。
  - **智能压缩**: 若图片超过 1MB，自动触发 Vision 3.0 的等比缩放与质量优化。
  - **清理**: 产生的临时文件在上传后会立即被抹除。

---

## 📄 班会记录解析 (重点)

在 `主题班会/` 的子目录下，你可以放置一份记录文件，系统会根据以下优先级自动提取内容用于 AI 生成：

| 优先级 | 文件格式 | 推荐程度 | 备注 |
| :--- | :--- | :--- | :--- |
| 1 | `.xlsx / .xls` | ⭐⭐⭐⭐⭐ | 结构化程度最高，最稳定 |
| 2 | `.txt` | ⭐⭐⭐⭐ | 简单直接 |
| 3 | `.docx` | ⭐⭐⭐ | 依赖 `python-docx` |
| 4 | `.pdf` | ⭐⭐ | 依赖 `pymupdf`，视觉垫底方案 |

### 📅 日期智能匹配
建议班会资源包目录以日期开头，例如：`2026.02.11 高二3班主题班会`。系统会自动提取任务中的日期进行精准对碰。

---

## 🐳 Docker 环境下的资源使用

默认情况下，Docker 镜像不包含 `assets/` 目录。如需使用本地资源，请在启动时挂载：

```bash
docker run -v "$(pwd)/assets:/app/comprehensive_eval_pro/assets" ...
```
