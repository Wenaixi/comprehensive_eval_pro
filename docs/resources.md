# 资源管理 (Resource Management)

CEP 采用严格的目录层级匹配算法，确保每个账户、每个任务都能精准对应到正确的素材。

## 1. 匹配逻辑 (Multi-Level Matching)

系统基于以下维度进行资源定位：

1.  **任务分类 (TaskType)**: 对应 `assets/` 下的一级子目录（如：主题班会、劳动、军训、国旗下讲话）。
2.  **学校 (School)**: 对应二级目录。
3.  **年级 (Grade)**: 对应三级目录。
4.  **班级 (Class)**: 对应四级目录。
5.  **任务名称 (TaskName)**: 对应文件夹名称（支持模糊匹配）。
6.  **日期 (Date)**: 优先匹配文件夹名中的日期字符串（如 `2026.02.12`）。

## 2. 目录结构示例

```text
assets/
└── 主题班会/
    └── 测试中学/
        └── 高一/
            └── 1班/
                └── 2026.02.12防欺凌主题班会/
                    ├── 班会记录.xlsx (语义来源)
                    ├── photo1.jpg
                    └── photo2.jpg
```

## 3. 资源优先级与解析

### 3.1 文本提取优先级
1.  **Excel**: 优先解析，支持多单元格语义合并。
2.  **Word**: 提取正文内容。
3.  **TXT**: 基础文本读取。
4.  **PDF (OCR)**: 当无上述文件时，系统会尝试对 PDF 进行视觉解析。

### 3.2 任务学时策略
系统会自动识别任务类型并分配学时：
- **军训**: 32.0
- **劳动**: 2.0
- **主题班会**: 1.0
- **普通任务**: 0.5

## 4. 故障排查

- **未匹配到资源**: 
  - 请检查文件夹是否放在了正确的分类目录下（如班会必须在 `assets/主题班会` 下）。
  - 检查文件夹名称是否包含任务关键字。
  - 确认 `accounts.txt` 中的信息与目录层级一致。
- **解析失败**: 确保 Excel/Word 文件未被其他程序占用，且格式规范。
